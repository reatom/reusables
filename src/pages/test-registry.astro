---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getAllReusables, getReusablesGroupedByType } from '../lib/registry';

const all = getAllReusables();
const grouped = getReusablesGroupedByType();
---

<BaseLayout>
  <main class="container" style="padding: 2rem;">
    <h1>Registry Data Layer Test</h1>

    <h2>Total reusables: {all.length}</h2>

    <h2>Grouped by type</h2>
    {grouped.map((group) => (
      <section>
        <h3>{group.type} ({group.items.length})</h3>
        <ul>
          {group.items.map((item) => (
            <li>
              <strong>{item.name}</strong> â€” type: {item.type}
              | doc: {item.doc ? `${item.doc.length} chars` : 'none'}
              | example: {item.example ? `${item.example.length} chars` : 'none'}
              | source: {item.source ? `${item.source.length} chars` : 'none'}
              | registryDeps: {JSON.stringify(item.registryDependencies)}
              | devDeps: {item.devDependencies.map(d => d.name).join(', ') || 'none'}
            </li>
          ))}
        </ul>
      </section>
    ))}

    <h2>Raw JSON dump</h2>
    <pre>{JSON.stringify(all, null, 2)}</pre>
  </main>
</BaseLayout>
